<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="baidu-site-verification" content="MVOLyQRxUt" />
  
  <title>网站服务器(Apach)日志读取分析成图及代码 | 自由自在</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="先说一句招黑的话：python是最好的编程语言！没有之一">
<meta property="og:type" content="article">
<meta property="og:title" content="网站服务器(Apach)日志读取分析成图及代码">
<meta property="og:url" content="http://zyouzz.github.io/2017/02/09/65202.html">
<meta property="og:site_name" content="自由自在">
<meta property="og:description" content="先说一句招黑的话：python是最好的编程语言！没有之一">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://zyouzz.github.io/images/02091.jpg">
<meta property="og:image" content="http://zyouzz.github.io/images/02092.jpg">
<meta property="og:image" content="http://zyouzz.github.io/images/02094.jpg">
<meta property="og:image" content="http://zyouzz.github.io/images/02093.jpg">
<meta property="og:image" content="http://zyouzz.github.io/images/02095.jpg">
<meta property="og:image" content="http://zyouzz.github.io/images/02096.jpg">
<meta property="og:image" content="http://zyouzz.github.io/images/02098.jpg">
<meta property="og:image" content="http://zyouzz.github.io/images/02097.jpg">
<meta property="article:published_time" content="2017-02-09T10:35:28.000Z">
<meta property="article:modified_time" content="2026-02-07T09:29:22.737Z">
<meta property="article:author" content="James Rock">
<meta property="article:tag" content="python">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://zyouzz.github.io/images/02091.jpg">
  
    <link rel="alternate" href="/atom.xml" title="自由自在" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  
    <link href="//fonts.loli.net/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

  
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?abe562be75947306c7e1bc11ba952568";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


  <meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
	  
      <h1 id="logo-wrap">
        <a href="/" id="logo">自由自在</a>
      </h1>
      
	  <form id="search-form">
				<input type="text" id="local-search-input" name="q" results="0" placeholder="搜一搜" class="search form-control" autocomplete="off" autocorrect="off" searchonload=""  style="height:25px"/>
				<i class="fa fa-times" onclick="resetSearch()"></i>
            </form>
            <div id="local-search-result"></div>
            <p class='no-result'>No results found <i class='fa fa-spinner fa-pulse'></i></p>
	      </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link"  style="font-weight:bold;font-size:20px"href="/">首页</a>
        
          <a class="main-nav-link"  style="font-weight:bold;font-size:20px"href="/archives">归档</a>
        
          <a class="main-nav-link"  style="font-weight:bold;font-size:20px"href="/tags/Cesium">Cesium</a>
        
          <a class="main-nav-link"  style="font-weight:bold;font-size:20px"href="/tags/WebGL">WebGL</a>
        
          <a class="main-nav-link"  style="font-weight:bold;font-size:20px"href="/tags/GIS">GIS</a>
        
          <a class="main-nav-link"  style="font-weight:bold;font-size:20px"href="/tags/RS">RS</a>
        
          <a class="main-nav-link"  style="font-weight:bold;font-size:20px"href="/about">关于</a>
        
      </nav>
      <nav id="sub-nav">
	  
           
      </nav>
      
    </div>
  </div>
</header>
<script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
<script src="/js/search.js"></script>

      <div class="outer">
        <section id="main"><article id="post-网站服务器-Apach-日志读取分析成图及代码" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/02/09/65202.html" class="article-date">
  <time datetime="2017-02-09T10:35:28.000Z" itemprop="datePublished">2017-02-09 18:35:28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/python/">python</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      网站服务器(Apach)日志读取分析成图及代码
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>先说一句招黑的话：python是最好的编程语言！<br><img src="/images/02091.jpg" alt="还有王法吗？"><br>没有之一<br><img src="/images/02092.jpg" alt="还有谁"></p>
<span id="more"></span>
<p>近来一直在学python，<br>最先知道python可以做爬虫，简单几行代码，轻松爬取网站的内容<br>上手也比较快，即学即上岗<br><img src="/images/02094.jpg" alt="即学即上岗"><br>python真是无所不能呀，越来越被人重视，现在是引用这张经典照片的时候了<br><img src="/images/02093.jpg" alt="人生苦短，我用python"><br>比如现在使用Arcpy写一写批处理的脚本，解决很多繁琐的问题<br>还有爬虫，将爬到的数据分析一下，很有成就感<br>++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++<br>过年放假前，接到一项挑战：将公司论坛网站（<a target="_blank" rel="noopener" href="http://zhihu.esrichina.com.cn/">ArcGIS知乎</a>）服务器上的Apach日志分析一下，看看网站论坛的搜索情况<br>日志是每天生成一个，一共是二百多天的，总共大概1.3个G，数量不大。</p>
<h2 id="读取数据-每天搜索次数统计"><a href="#读取数据-每天搜索次数统计" class="headerlink" title="读取数据 每天搜索次数统计"></a>读取数据 每天搜索次数统计</h2><p>1、首先肯定是看一下这些文件名字，嗯，很正规，方便后续的读取和存储<br><img src="/images/02095.jpg" alt="日志"><br>2、然后随便打开一个文件，分析一下存储结构，<br>然后找到自己需要的内容，初步思考怎么提取出来<br><img src="/images/02096.jpg" alt="文件"><br>3、接着尝试写代码读取一个文件看看，无压力<br>4、现在要的是将里面有形如“GET //search/ajax/search_result/search_type-questions__q-%E5%85%A5%E9%97%A8”搜索的请求行取出来，找到其中q-%E5%85%A5%E9%97%A8字符串，<br>然后使用“urllib.parse.unquote”转码，转为可以读懂的关键词，这就是要的结果了<br>5、读取到每个日志文件中的关键词后，将其存储到文本中,代码如下，</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">###读取源数据，通过挑选、反编码并写入内存</span></span><br><span class="line">rootdir = <span class="string">&quot;C://Users//Esri//Desktop//log&quot;</span></span><br><span class="line">loglist = []</span><br><span class="line">tongjilist = []</span><br><span class="line"><span class="keyword">for</span> parent, dirnames, filenames <span class="keyword">in</span> os.walk(rootdir):</span><br><span class="line">    day = <span class="number">1</span></span><br><span class="line">    i = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> filename <span class="keyword">in</span> filenames:</span><br><span class="line">        filedate = filename[<span class="number">7</span>:-<span class="number">4</span>]</span><br><span class="line">        filepath = os.path.join(parent, filename)</span><br><span class="line">        <span class="comment"># print(filedate)</span></span><br><span class="line">        <span class="comment"># print(filepath)</span></span><br><span class="line">        <span class="built_in">input</span> = <span class="built_in">open</span>(filepath, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">        num = <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> <span class="built_in">input</span>:</span><br><span class="line">            <span class="keyword">if</span> (</span><br><span class="line">                    <span class="string">&#x27;GET //search/ajax/search_result/search_type-questions__q-&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;template-__page-1&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;search_type-questions&#x27;</span>) <span class="keyword">in</span> line:</span><br><span class="line">                kw1 = line.split()[<span class="number">6</span>][<span class="number">53</span>:-<span class="number">19</span>]</span><br><span class="line">                kw = urllib.parse.unquote(kw1).replace(<span class="string">&#x27;_&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">                <span class="keyword">if</span> <span class="string">&#x27;?&#x27;</span> <span class="keyword">in</span> kw:</span><br><span class="line">                    <span class="keyword">pass</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="comment"># file1 = open(&#x27;C://Users//Esri//Desktop//statistics//原始数据.txt&#x27;, &#x27;a&#x27;,encoding=&#x27;utf-8&#x27;)</span></span><br><span class="line">                    logline = <span class="built_in">str</span>(line.split()[<span class="number">0</span>]) + <span class="string">&#x27;,&#x27;</span> + <span class="built_in">str</span>(line.split()[<span class="number">3</span>][<span class="number">1</span>:]) + <span class="string">&#x27;,&#x27;</span> + kw + <span class="string">&#x27;\n&#x27;</span></span><br><span class="line">                    loglist.append(logline)</span><br><span class="line">                    <span class="comment"># file1 = file1.write(line1)</span></span><br><span class="line">                    <span class="comment"># print(i)</span></span><br><span class="line">                    i += <span class="number">1</span></span><br><span class="line">                    num += <span class="number">1</span></span><br><span class="line">        day += <span class="number">1</span></span><br><span class="line">        <span class="built_in">print</span>(filedate + <span class="string">&quot;:共有&quot;</span> + <span class="built_in">str</span>(num) + <span class="string">&quot;次搜索&quot;</span>)</span><br><span class="line">        <span class="comment"># file2 = open(&#x27;C://Users//Esri//Desktop//statistics//每天搜索次数统计.txt&#x27;, &#x27;a&#x27;)</span></span><br><span class="line">        tongjiline = filedate + <span class="string">&#x27;,&#x27;</span> + <span class="built_in">str</span>(num) + <span class="string">&#x27;\n&#x27;</span></span><br><span class="line">        tongjilist.append(tongjiline)</span><br><span class="line"><span class="comment">###创建文本并写入数据表头</span></span><br><span class="line">log = <span class="built_in">open</span>(<span class="string">&#x27;C://Users//Esri//Desktop//statistics//原始数据.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">loghead = <span class="string">&quot;IP&quot;</span> + <span class="string">&#x27;,&#x27;</span> + <span class="string">&quot;日期&quot;</span> + <span class="string">&#x27;,&#x27;</span> + <span class="string">&quot;搜索关键词&quot;</span> + <span class="string">&#x27;\n&#x27;</span></span><br><span class="line">log.write(loghead)  <span class="comment"># 写文件头</span></span><br><span class="line">log.close()</span><br><span class="line">tongji = <span class="built_in">open</span>(<span class="string">&#x27;C://Users//Esri//Desktop//statistics//每天搜索次数统计.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">tongjihead = <span class="string">&quot;日期&quot;</span> + <span class="string">&#x27;,&#x27;</span> + <span class="string">&quot;次数&quot;</span> + <span class="string">&#x27;\n&#x27;</span></span><br><span class="line">tongji.write(tongjihead)  <span class="comment"># 写文件头</span></span><br><span class="line">tongji.close()</span><br><span class="line"><span class="comment">###将内存的list保存到文本中</span></span><br><span class="line">openlog = <span class="built_in">open</span>(<span class="string">&#x27;C://Users//Esri//Desktop//statistics//原始数据.txt&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">openlog.writelines(loglist)</span><br><span class="line">openlog.close()</span><br><span class="line">opentongji = <span class="built_in">open</span>(<span class="string">&#x27;C://Users//Esri//Desktop//statistics//每天搜索次数统计.txt&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">opentongji.writelines(tongjilist)</span><br><span class="line">opentongji.close()</span><br><span class="line"><span class="keyword">del</span> loglist</span><br><span class="line"><span class="keyword">del</span> tongjilist</span><br><span class="line">day -= <span class="number">1</span></span><br><span class="line">sumday = i - <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>(day) + <span class="string">&quot;天一共有：&quot;</span> + <span class="built_in">str</span>(sumday) + <span class="string">&quot;次搜索&quot;</span>)</span><br><span class="line"><span class="comment"># print(filedate)</span></span><br><span class="line">startday = (datetime.datetime.strptime(filedate, <span class="string">&quot;%Y-%m-%d&quot;</span>) - datetime.timedelta(days=day - <span class="number">1</span>)).strftime(<span class="string">&quot;%Y-%m-%d&quot;</span>)</span><br><span class="line"><span class="comment"># print(startday)</span></span><br></pre></td></tr></table></figure>

<p>PS：读取完文件花了10S</p>
<h2 id="同一IP、日期、搜索关键词结果去重"><a href="#同一IP、日期、搜索关键词结果去重" class="headerlink" title="同一IP、日期、搜索关键词结果去重"></a>同一IP、日期、搜索关键词结果去重</h2><p>好了，得到初步结果。<br>通过代码，可以看到：每天搜索次数统计.txt中包含了三方面的内容：IP，时间，搜索关键词，<br>对于同一IP，同一时间，同一搜索关键词进行去重，得到清洗后的数据源，才能进行后续的有效分析<br>代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;同一IP、日期、搜索关键词结果去重&#x27;&#x27;&#x27;</span></span><br><span class="line">lines_seen = <span class="built_in">set</span>()</span><br><span class="line">outfile = <span class="built_in">open</span>(<span class="string">&#x27;C://Users//Esri//Desktop//statistics//nodate.txt&#x27;</span>, <span class="string">&quot;w&quot;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> <span class="built_in">open</span>(<span class="string">&#x27;C://Users//Esri//Desktop//statistics//原始数据.txt&#x27;</span>, <span class="string">&quot;r&quot;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>):</span><br><span class="line">    outfile = <span class="built_in">open</span>(<span class="string">&#x27;C://Users//Esri//Desktop//statistics//nodate.txt&#x27;</span>, <span class="string">&quot;a&quot;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    rline1 = line.split(<span class="string">&#x27;,&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">    <span class="comment"># print(rline1)</span></span><br><span class="line">    rline2 = line.split(<span class="string">&#x27;,&#x27;</span>)[<span class="number">2</span>]</span><br><span class="line">    <span class="comment"># print(rline2)</span></span><br><span class="line">    rline3 = line.split(<span class="string">&#x27;,&#x27;</span>)[<span class="number">1</span>][:-<span class="number">9</span>]</span><br><span class="line">    <span class="comment"># print(rline3)</span></span><br><span class="line">    reline = rline1 + <span class="string">&#x27;,&#x27;</span> + rline3 + <span class="string">&#x27;,&#x27;</span> + rline2</span><br><span class="line">    <span class="keyword">if</span> reline <span class="keyword">not</span> <span class="keyword">in</span> lines_seen:</span><br><span class="line">        <span class="comment"># print(&#x27;reline:&#x27;+reline)</span></span><br><span class="line">        outfile.write(reline)</span><br><span class="line">        lines_seen.add(reline)</span><br><span class="line">opendupbeta = <span class="built_in">open</span>(<span class="string">&#x27;C://Users//Esri//Desktop//statistics//nodate.txt&#x27;</span>, <span class="string">&quot;r&quot;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">opendup = <span class="built_in">open</span>(<span class="string">&#x27;C://Users//Esri//Desktop//statistics//爬取的数据源.txt&#x27;</span>, <span class="string">&quot;w&quot;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">opendup.write(re.sub(<span class="string">r&#x27;IP,,搜索关键词&#x27;</span>, <span class="string">&#x27;IP,日期,搜索关键词&#x27;</span>, opendupbeta.read()))</span><br><span class="line">opendupbeta.close()</span><br><span class="line">opendup.close</span><br></pre></td></tr></table></figure>

<h2 id="搜索关键词Top100统计"><a href="#搜索关键词Top100统计" class="headerlink" title="搜索关键词Top100统计"></a>搜索关键词Top100统计</h2><p>有了数据能做些什么呢？<br>既然是网站论坛的搜索关键词统计，那么统计一下搜索次数最高的关键词 TOP100！<br>python很容易上手，那么问题来了：你将对Python的了解不够深入。<br>所以在你开始实现自己的想法时，一种“朴素的编程思想”贯穿脑中，费尽心力写了几十行，还不怎么完美<br>最后发现该功能已经写成函数了，你只需用一行去调用即可。<br>这里不禁感叹python的强大：没有做不到的，只有你想不到的。<br>好吧，这是我的心得体会！<br>附上统计Top100的代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;搜索关键词Top100统计&#x27;&#x27;&#x27;</span></span><br><span class="line">outfile1 = <span class="built_in">open</span>(<span class="string">&#x27;C://Users//Esri//Desktop//statistics//frequencybeta.txt&#x27;</span>, <span class="string">&quot;w&quot;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">outfile2 = <span class="built_in">open</span>(<span class="string">&#x27;C://Users//Esri//Desktop//statistics//爬取的数据源.txt&#x27;</span>, <span class="string">&quot;r&quot;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> outfile2:</span><br><span class="line">    reline1 = line.split(<span class="string">&#x27;,&#x27;</span>)[<span class="number">2</span>]</span><br><span class="line">    outfile1.write(reline1)</span><br><span class="line">outfile1.close()</span><br><span class="line">outfile2.close()</span><br><span class="line">f1 = <span class="built_in">open</span>(<span class="string">&#x27;C://Users//Esri//Desktop//statistics//frequencybeta.txt&#x27;</span>, <span class="string">&quot;r&quot;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">f2 = <span class="built_in">open</span>(<span class="string">&#x27;C://Users//Esri//Desktop//statistics//frequency.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">f2.write(re.sub(<span class="string">r&#x27;搜索关键词&#x27;</span>, <span class="string">&#x27;&#x27;</span>, f1.read()))</span><br><span class="line">f1.close()</span><br><span class="line">f2.close()</span><br><span class="line">openfre = <span class="built_in">open</span>(<span class="string">&#x27;C://Users//Esri//Desktop//statistics//frequency.txt&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">str1 = openfre.read().lower().split()</span><br><span class="line"><span class="comment"># print(str1)</span></span><br><span class="line"><span class="comment"># print(&quot;原文本:\n %s&quot;% str1)</span></span><br><span class="line"><span class="comment"># print(&quot;\n各词出现的次数：\n %s&quot; % collections.Counter(str1))</span></span><br><span class="line"><span class="comment"># print(type(collections.Counter(str1)))</span></span><br><span class="line"><span class="comment"># cishu= collections.Counter(str1)</span></span><br><span class="line"><span class="comment"># for  ci in str1:</span></span><br><span class="line"><span class="comment"># print(ci, cishu[ci])</span></span><br><span class="line"><span class="comment"># print(collections.Counter(str1)[&#x27;arcgis&#x27;])#以字典的形式存储，每个关键词对应的键值就是在文本中出现的次数</span></span><br><span class="line">mc100 = re.sub(<span class="string">&#x27;\ |\[|\]|\(|\)|\&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="built_in">str</span>(collections.Counter(str1).most_common(<span class="number">100</span>)))</span><br><span class="line"><span class="comment"># print(mc100)</span></span><br><span class="line">msarr = mc100.split(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line"><span class="comment"># print(type(msarr))</span></span><br><span class="line">openfre.close()</span><br><span class="line">file3 = <span class="built_in">open</span>(<span class="string">&#x27;C://Users//Esri//Desktop//statistics//关键词top100.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">line3 = <span class="string">&quot;关键词&quot;</span> + <span class="string">&#x27;,&#x27;</span> + <span class="string">&quot;次数&quot;</span> + <span class="string">&#x27;\n&#x27;</span></span><br><span class="line">file3_ = file3.write(line3)</span><br><span class="line">i = <span class="number">1</span></span><br><span class="line">x = []</span><br><span class="line">y = []</span><br><span class="line">file3.close()</span><br><span class="line"><span class="keyword">for</span> xunhuan <span class="keyword">in</span> msarr:</span><br><span class="line">    file4 = <span class="built_in">open</span>(<span class="string">&#x27;C://Users//Esri//Desktop//statistics//关键词top100.txt&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">2</span> != <span class="number">0</span>:</span><br><span class="line">        xunhuandot = xunhuan + <span class="string">&quot;,&quot;</span></span><br><span class="line">        file4.write(xunhuandot)</span><br><span class="line">        x.append(xunhuan)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        xunhuanbr = xunhuan + <span class="string">&#x27;\n&#x27;</span></span><br><span class="line">        file4.write(xunhuanbr)</span><br><span class="line">        y.append(<span class="built_in">int</span>(xunhuan))</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line"><span class="comment"># print(x)</span></span><br><span class="line"><span class="comment"># print(y)</span></span><br><span class="line">file3.close()</span><br><span class="line">file4.close()</span><br></pre></td></tr></table></figure>

<h2 id="按月份统计搜索次数"><a href="#按月份统计搜索次数" class="headerlink" title="按月份统计搜索次数"></a>按月份统计搜索次数</h2><p>有了每天的搜索次数，就可以得到每月的搜索次数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;按月份统计汇总&#x27;&#x27;&#x27;</span></span><br><span class="line">openutj = <span class="built_in">open</span>(<span class="string">&#x27;C://Users//Esri//Desktop//statistics//uheadtongji.txt&#x27;</span>,<span class="string">&quot;r&quot;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">umonth=[]</span><br><span class="line"><span class="keyword">for</span> line5 <span class="keyword">in</span> openutj.read().split(<span class="string">&#x27;\n&#x27;</span>):</span><br><span class="line">    umonth.append(line5[:<span class="number">7</span>])</span><br><span class="line"><span class="comment">#print(year)</span></span><br><span class="line"><span class="comment">#print(month)</span></span><br><span class="line">openutj.close()</span><br><span class="line">outfile7 = <span class="built_in">open</span>(<span class="string">&#x27;C://Users//Esri//Desktop//statistics//每月搜索次数统计.txt&#x27;</span>, <span class="string">&quot;w&quot;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">headms=<span class="string">&#x27;月份&#x27;</span>+<span class="string">&#x27;,&#x27;</span>+<span class="string">&#x27;次数&#x27;</span>+<span class="string">&#x27;\n&#x27;</span></span><br><span class="line">outfile7.write(headms)</span><br><span class="line">outfile7.close()</span><br><span class="line">uyemon=[]</span><br><span class="line"><span class="keyword">for</span> mon <span class="keyword">in</span> umonth:</span><br><span class="line">    <span class="comment">#print(mon)</span></span><br><span class="line">    openutj1 = <span class="built_in">open</span>(<span class="string">&#x27;C://Users//Esri//Desktop//statistics//uheadtongji.txt&#x27;</span>, <span class="string">&quot;r&quot;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    summ=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> line6 <span class="keyword">in</span> openutj1.read().split(<span class="string">&#x27;\n&#x27;</span>):</span><br><span class="line">        monn=line6[:<span class="number">7</span>]</span><br><span class="line">        <span class="keyword">if</span> monn==mon:</span><br><span class="line">            summ+=<span class="built_in">int</span>(line6[<span class="number">11</span>:])</span><br><span class="line">    uyemon.append(summ)</span><br><span class="line"><span class="comment">#print(uyemon)</span></span><br><span class="line">month=[]</span><br><span class="line"><span class="keyword">for</span> dmonth <span class="keyword">in</span> umonth:</span><br><span class="line">    <span class="keyword">if</span> dmonth <span class="keyword">not</span> <span class="keyword">in</span> month:</span><br><span class="line">        month.append(dmonth)</span><br><span class="line"><span class="comment">#print(month)</span></span><br><span class="line">yemon=[]</span><br><span class="line"><span class="keyword">for</span> dyemon <span class="keyword">in</span> uyemon:</span><br><span class="line">    <span class="keyword">if</span> dyemon <span class="keyword">not</span> <span class="keyword">in</span> yemon:</span><br><span class="line">        yemon.append(dyemon)</span><br><span class="line"><span class="comment">#print(yemon)</span></span><br><span class="line">openutj1.close()</span><br><span class="line">i22=<span class="number">0</span></span><br><span class="line">sousuo=[]</span><br><span class="line"><span class="keyword">for</span> c22 <span class="keyword">in</span> month:</span><br><span class="line">    i22+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> i22!=<span class="built_in">len</span>(month):</span><br><span class="line">        sousuo.append(<span class="built_in">str</span>(c22)+<span class="string">&#x27;,&#x27;</span>+<span class="built_in">str</span>(yemon[i22-<span class="number">1</span>])+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        sousuo.append(<span class="built_in">str</span>(c22) + <span class="string">&#x27;,&#x27;</span> + <span class="built_in">str</span>(yemon[i22 - <span class="number">1</span>]))</span><br><span class="line"><span class="comment">#print(sousuo)</span></span><br><span class="line">openmeiyue=<span class="built_in">open</span>(<span class="string">&#x27;C://Users//Esri//Desktop//statistics//每月搜索次数统计.txt&#x27;</span>, <span class="string">&quot;a&quot;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">openmeiyue.writelines(sousuo)</span><br><span class="line"><span class="comment">#print(sousuo)</span></span><br><span class="line">openmeiyue.close()</span><br></pre></td></tr></table></figure>

<h2 id="统计结果成图"><a href="#统计结果成图" class="headerlink" title="统计结果成图"></a>统计结果成图</h2><p>得到统计结果后，可以通过python的matplotlib等库可视化数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;每天统计成图&#x27;&#x27;&#x27;</span></span><br><span class="line">opentj1 = <span class="built_in">open</span>(<span class="string">&#x27;C://Users//Esri//Desktop//statistics//每天搜索次数统计.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">openu1 = <span class="built_in">open</span>(<span class="string">&#x27;C://Users//Esri//Desktop//statistics//uheadtongji.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">jishu = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> line1 <span class="keyword">in</span> opentj1.read().split(<span class="string">&#x27;\n&#x27;</span>):</span><br><span class="line">    <span class="comment"># print(line1)</span></span><br><span class="line">    jishu += <span class="number">1</span></span><br><span class="line"><span class="comment"># print(jishu)</span></span><br><span class="line">num = <span class="number">0</span></span><br><span class="line">opentj2 = <span class="built_in">open</span>(<span class="string">&#x27;C://Users//Esri//Desktop//statistics//每天搜索次数统计.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> opentj2.read().split(<span class="string">&#x27;\n&#x27;</span>):</span><br><span class="line">    <span class="comment"># print(line)</span></span><br><span class="line">    openu2 = <span class="built_in">open</span>(<span class="string">&#x27;C://Users//Esri//Desktop//statistics//uheadtongji.txt&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="comment"># print(line3)</span></span><br><span class="line">    <span class="keyword">if</span> line == <span class="string">&#x27;日期,次数&#x27;</span> <span class="keyword">or</span> line == <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> num != jishu - <span class="number">2</span>:</span><br><span class="line">            openu2.write(line + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            openu2.write(line)</span><br><span class="line">    num += <span class="number">1</span></span><br><span class="line">opentj1.close()</span><br><span class="line">opentj2.close()</span><br><span class="line">f5 = <span class="built_in">open</span>(<span class="string">&#x27;C://Users//Esri//Desktop//statistics//uheadtongji.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>).read().replace(<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;,&#x27;</span>).split(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line"><span class="comment"># print(f5)</span></span><br><span class="line">jishu2 = <span class="number">1</span></span><br><span class="line">x = []</span><br><span class="line">y = []</span><br><span class="line"><span class="keyword">for</span> uh <span class="keyword">in</span> f5:</span><br><span class="line">    <span class="comment"># print(uh)</span></span><br><span class="line">    <span class="keyword">if</span> jishu2 % <span class="number">2</span> != <span class="number">0</span>:</span><br><span class="line">        x.append(uh)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        y.append(<span class="built_in">int</span>(uh))</span><br><span class="line">    jishu2 += <span class="number">1</span></span><br><span class="line">jishu1 = <span class="number">1</span></span><br><span class="line">x1 = []</span><br><span class="line"><span class="keyword">for</span> jishu1 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(x) + <span class="number">1</span>):</span><br><span class="line">    x1.append(<span class="built_in">int</span>(jishu1))</span><br><span class="line"><span class="comment"># print(x1)</span></span><br><span class="line">DataX = <span class="built_in">tuple</span>(x1)</span><br><span class="line"><span class="comment"># print(type(DataX))</span></span><br><span class="line">DataY = <span class="built_in">tuple</span>(y)</span><br><span class="line"></span><br><span class="line">fig3 = pl.figure()</span><br><span class="line">fig3.set_size_inches(<span class="number">30</span>, <span class="number">10.5</span>)</span><br><span class="line">plt.title(</span><br><span class="line">    <span class="string">&#x27;ArcGIS知乎站内搜索每天统计（&#x27;</span> + startday + <span class="string">&#x27;至&#x27;</span> + filedate + <span class="string">&#x27;）&#x27;</span> + <span class="string">&#x27;\n&#x27;</span> + <span class="string">&#x27;(&#x27;</span> + <span class="built_in">str</span>(day) + <span class="string">&quot;天一共有：&quot;</span> + <span class="built_in">str</span>(sumday) + <span class="string">&quot;次搜索)&quot;</span>,</span><br><span class="line">    fontsize=<span class="number">26</span>)</span><br><span class="line">plt.xticks(fontsize=<span class="number">20</span>)</span><br><span class="line">plt.yticks(fontsize=<span class="number">20</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;日期(&#x27;</span> + startday + <span class="string">&#x27;+)&#x27;</span>, fontsize=<span class="number">23</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;次数&#x27;</span>, fontsize=<span class="number">23</span>)</span><br><span class="line">plt.plot(x1, y, <span class="string">&#x27;b*&#x27;</span>)  <span class="comment"># use pylab to plot x and y</span></span><br><span class="line">plt.plot(x1, y, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i, (_x, _y,_z) <span class="keyword">in</span> <span class="built_in">enumerate</span>(<span class="built_in">zip</span>(x1, y,y)):</span><br><span class="line">    plt.text(_x, _y, _z, color=<span class="string">&#x27;red&#x27;</span>, fontsize=<span class="number">25</span>)</span><br><span class="line">savets = <span class="string">&quot;C:/Users/Esri/Desktop/&quot;</span> + re.sub(<span class="string">&#x27;:&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="built_in">str</span>(datetime.datetime.now())) + <span class="string">&quot;ts.png&quot;</span></span><br><span class="line">fig3.savefig(savets, dpi=<span class="number">100</span>)</span><br><span class="line"><span class="comment"># pl.show()  # show the plot on the screen</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;每月统计折点图&#x27;&#x27;&#x27;</span></span><br><span class="line">openmonth=<span class="built_in">open</span>(<span class="string">&#x27;C://Users//Esri//Desktop//statistics//每月搜索次数统计.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">realmonth=[]</span><br><span class="line">monsta=[]</span><br><span class="line"><span class="keyword">for</span> monybeta <span class="keyword">in</span> openmonth:</span><br><span class="line">    mony=monybeta.replace(<span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;&#x27;</span>).split(<span class="string">&#x27;,&#x27;</span>)[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">if</span> mony!=<span class="string">&#x27;次数&#x27;</span>:</span><br><span class="line">        monsta.append(mony)</span><br><span class="line">        realmonth.append(monybeta[<span class="number">5</span>:<span class="number">7</span>])</span><br><span class="line">mons=[]</span><br><span class="line"><span class="comment">#print(len(monsta))</span></span><br><span class="line"><span class="keyword">for</span> monx <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(monsta)):</span><br><span class="line">    mons.append(monx+<span class="number">1</span>)</span><br><span class="line"><span class="comment">#print(monsta)</span></span><br><span class="line"><span class="comment">#print(mons)</span></span><br><span class="line">fig4 = plt.figure()</span><br><span class="line">fig4.set_size_inches(<span class="number">30</span>, <span class="number">10.5</span>)</span><br><span class="line">plt.title(</span><br><span class="line">    <span class="string">&#x27;ArcGIS知乎站内搜索每月统计（&#x27;</span> + startday + <span class="string">&#x27;至&#x27;</span> + filedate + <span class="string">&#x27;）&#x27;</span> + <span class="string">&#x27;\n&#x27;</span> + <span class="string">&#x27;(&#x27;</span> + <span class="built_in">str</span>(day) + <span class="string">&quot;天一共有：&quot;</span> + <span class="built_in">str</span>(sumday) + <span class="string">&quot;次搜索)&quot;</span>,</span><br><span class="line">    fontsize=<span class="number">26</span>)</span><br><span class="line">plt.xticks(fontsize=<span class="number">20</span>)</span><br><span class="line">plt.yticks(fontsize=<span class="number">20</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;月份(&#x27;</span> + <span class="built_in">str</span>(startday)[<span class="number">5</span>:<span class="number">7</span>] + <span class="string">&#x27;月份开始--)&#x27;</span>, fontsize=<span class="number">23</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;次数&#x27;</span>, fontsize=<span class="number">23</span>)</span><br><span class="line">plt.plot(mons, monsta, <span class="string">&#x27;bo&#x27;</span>,mons, monsta, <span class="string">&#x27;r&#x27;</span>)  <span class="comment"># use pylab to plot x and y</span></span><br><span class="line"><span class="comment">#plt.plot(mons, monsta, &#x27;r&#x27;)</span></span><br><span class="line">plt.xticks(mons, realmonth, fontsize=<span class="number">20</span>)</span><br><span class="line"><span class="keyword">for</span> i, (_x, _y,_z) <span class="keyword">in</span> <span class="built_in">enumerate</span>(<span class="built_in">zip</span>(mons, monsta,monsta)):</span><br><span class="line">    plt.text(_x, _y, _z, color=<span class="string">&#x27;red&#x27;</span>, fontsize=<span class="number">25</span>)</span><br><span class="line">savemonth = <span class="string">&quot;C:/Users/Esri/Desktop/&quot;</span> + re.sub(<span class="string">&#x27;:&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="built_in">str</span>(datetime.datetime.now())) + <span class="string">&quot;month.png&quot;</span></span><br><span class="line">fig4.savefig(savemonth, dpi=<span class="number">100</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;top20成图&#x27;&#x27;&#x27;</span></span><br><span class="line">x = x[:<span class="number">20</span>]</span><br><span class="line">y = y[:<span class="number">20</span>]</span><br><span class="line">i = <span class="number">1</span></span><br><span class="line">x1 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(x) + <span class="number">1</span>):</span><br><span class="line">    x1.append(<span class="built_in">int</span>(i)+<span class="number">5</span>)</span><br><span class="line">DataX = <span class="built_in">tuple</span>(x1)</span><br><span class="line"><span class="comment"># print(type(DataX))</span></span><br><span class="line">DataY = <span class="built_in">tuple</span>(y)</span><br><span class="line"><span class="comment"># print(type(DataY))</span></span><br><span class="line">fig1 = plt.figure()</span><br><span class="line">fig1.set_size_inches(<span class="number">30</span>, <span class="number">15</span>)</span><br><span class="line"><span class="comment"># plt.xlim()</span></span><br><span class="line">rects = plt.bar(left=DataX, height=DataY, width=<span class="number">0.5</span>, align=<span class="string">&quot;center&quot;</span>, yerr=<span class="number">0.000001</span>, facecolor=<span class="string">&#x27;lightskyblue&#x27;</span>,</span><br><span class="line">                edgecolor=<span class="string">&#x27;white&#x27;</span>)</span><br><span class="line">plt.plot(DataX,DataY)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">autolabel</span>(<span class="params">rects</span>):</span><br><span class="line">    <span class="keyword">for</span> rect <span class="keyword">in</span> rects:</span><br><span class="line">        height = rect.get_height()</span><br><span class="line">        plt.text(rect.get_x() + rect.get_width() / <span class="number">3.</span>, <span class="number">1.01</span> * height, <span class="string">&#x27;%s&#x27;</span> % <span class="built_in">int</span>(height), color=<span class="string">&#x27;red&#x27;</span>, fontsize=<span class="number">25</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">autolabel(rects)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;关键词&#x27;</span>, fontsize=<span class="number">23</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;次数&#x27;</span>, fontsize=<span class="number">23</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;ArcGIS知乎站内搜索关键词统计（&#x27;</span> + startday + <span class="string">&#x27;至&#x27;</span> + filedate + <span class="string">&#x27;）top20统计&#x27;</span> + <span class="string">&#x27;\n&#x27;</span> + <span class="string">&#x27;(&#x27;</span> + <span class="built_in">str</span>(day) + <span class="string">&quot;天一共有：&quot;</span> + <span class="built_in">str</span>(</span><br><span class="line">    sumday) + <span class="string">&quot;次搜索)&quot;</span>, fontsize=<span class="number">26</span>)</span><br><span class="line">plt.yticks(fontsize=<span class="number">20</span>)</span><br><span class="line">plt.xticks(DataX, <span class="built_in">tuple</span>(x), fontsize=<span class="number">20</span>)</span><br><span class="line">savename = <span class="string">&quot;C:/Users/Esri/Desktop/&quot;</span> + re.sub(<span class="string">&#x27;:&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="built_in">str</span>(datetime.datetime.now())) + <span class="string">&quot;.png&quot;</span></span><br><span class="line"><span class="comment"># print(savename)</span></span><br><span class="line">fig1.savefig(savename, dpi=<span class="number">100</span>)</span><br><span class="line"><span class="comment"># plt.show()</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;top20成图&#x27;&#x27;&#x27;</span></span><br><span class="line">x = x[:<span class="number">20</span>]</span><br><span class="line">y = y[:<span class="number">20</span>]</span><br><span class="line">i = <span class="number">1</span></span><br><span class="line">x1 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(x) + <span class="number">1</span>):</span><br><span class="line">    x1.append(<span class="built_in">int</span>(i)+<span class="number">5</span>)</span><br><span class="line">DataX = <span class="built_in">tuple</span>(x1)</span><br><span class="line"><span class="comment"># print(type(DataX))</span></span><br><span class="line">DataY = <span class="built_in">tuple</span>(y)</span><br><span class="line"><span class="comment"># print(type(DataY))</span></span><br><span class="line">fig1 = plt.figure()</span><br><span class="line">fig1.set_size_inches(<span class="number">30</span>, <span class="number">15</span>)</span><br><span class="line"><span class="comment"># plt.xlim()</span></span><br><span class="line">rects = plt.bar(left=DataX, height=DataY, width=<span class="number">0.5</span>, align=<span class="string">&quot;center&quot;</span>, yerr=<span class="number">0.000001</span>, facecolor=<span class="string">&#x27;lightskyblue&#x27;</span>,</span><br><span class="line">                edgecolor=<span class="string">&#x27;white&#x27;</span>)</span><br><span class="line">plt.plot(DataX,DataY)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">autolabel</span>(<span class="params">rects</span>):</span><br><span class="line">    <span class="keyword">for</span> rect <span class="keyword">in</span> rects:</span><br><span class="line">        height = rect.get_height()</span><br><span class="line">        plt.text(rect.get_x() + rect.get_width() / <span class="number">3.</span>, <span class="number">1.01</span> * height, <span class="string">&#x27;%s&#x27;</span> % <span class="built_in">int</span>(height), color=<span class="string">&#x27;red&#x27;</span>, fontsize=<span class="number">25</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">autolabel(rects)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;关键词&#x27;</span>, fontsize=<span class="number">23</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;次数&#x27;</span>, fontsize=<span class="number">23</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;ArcGIS知乎站内搜索关键词统计（&#x27;</span> + startday + <span class="string">&#x27;至&#x27;</span> + filedate + <span class="string">&#x27;）top20统计&#x27;</span> + <span class="string">&#x27;\n&#x27;</span> + <span class="string">&#x27;(&#x27;</span> + <span class="built_in">str</span>(day) + <span class="string">&quot;天一共有：&quot;</span> + <span class="built_in">str</span>(</span><br><span class="line">    sumday) + <span class="string">&quot;次搜索)&quot;</span>, fontsize=<span class="number">26</span>)</span><br><span class="line">plt.yticks(fontsize=<span class="number">20</span>)</span><br><span class="line">plt.xticks(DataX, <span class="built_in">tuple</span>(x), fontsize=<span class="number">20</span>)</span><br><span class="line">savename = <span class="string">&quot;C:/Users/Esri/Desktop/&quot;</span> + re.sub(<span class="string">&#x27;:&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="built_in">str</span>(datetime.datetime.now())) + <span class="string">&quot;.png&quot;</span></span><br><span class="line"><span class="comment"># print(savename)</span></span><br><span class="line">fig1.savefig(savename, dpi=<span class="number">100</span>)</span><br><span class="line"><span class="comment"># plt.show()</span></span><br></pre></td></tr></table></figure>

<h2 id="由于上述都是以txt文档的形式保存数据，为方便出图，可以转成Excel格式，实现代码如下"><a href="#由于上述都是以txt文档的形式保存数据，为方便出图，可以转成Excel格式，实现代码如下" class="headerlink" title="由于上述都是以txt文档的形式保存数据，为方便出图，可以转成Excel格式，实现代码如下"></a>由于上述都是以txt文档的形式保存数据，为方便出图，可以转成Excel格式，实现代码如下</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">txt_to_xlsx</span>(<span class="params">txtpath</span>):</span><br><span class="line">    exc = xlsxwriter.Workbook(</span><br><span class="line">        <span class="string">&#x27;C://Users//Esri//Desktop//statistics//&#x27;</span> + txtpath.split(<span class="string">&#x27;//&#x27;</span>)[-<span class="number">1</span>].split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">0</span>] + <span class="string">&#x27;.xlsx&#x27;</span>)</span><br><span class="line">    worksheet = exc.add_worksheet()</span><br><span class="line">    openf = <span class="built_in">open</span>(txtpath, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    opentxt = openf.read().split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    txtline = <span class="number">0</span></span><br><span class="line">    spaceline = <span class="number">0</span></span><br><span class="line">    storesp = <span class="built_in">set</span>()</span><br><span class="line">    newtxt = []</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;首先去掉空行&#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> opentxt:</span><br><span class="line">        <span class="comment"># print(line)</span></span><br><span class="line">        txtline += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> line != <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">            newtxt.append(line)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            spaceline += <span class="number">1</span></span><br><span class="line">            storesp.add(txtline)</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;将内存中list写入xlsx&#x27;&#x27;&#x27;</span></span><br><span class="line">    colnums = <span class="built_in">len</span>(newtxt[<span class="number">0</span>].split(<span class="string">&#x27;,&#x27;</span>))</span><br><span class="line">    maxwidth = <span class="number">0</span></span><br><span class="line">    linenum = <span class="built_in">len</span>(newtxt)</span><br><span class="line">    <span class="keyword">for</span> colnum <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, colnums):</span><br><span class="line">        <span class="keyword">for</span> linenums <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, linenum):</span><br><span class="line">            wid = <span class="built_in">len</span>(newtxt[linenums].split(<span class="string">&#x27;,&#x27;</span>)[colnum])</span><br><span class="line">            <span class="keyword">if</span> wid &gt;= maxwidth:</span><br><span class="line">                maxwidth = wid</span><br><span class="line">        worksheet.set_column(colnum, colnum, width=maxwidth)</span><br><span class="line">        <span class="keyword">for</span> linenumss <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, linenum):</span><br><span class="line">            worksheet.write(linenumss, colnum, newtxt[linenumss].split(<span class="string">&#x27;,&#x27;</span>)[colnum])</span><br><span class="line">    exc.close()</span><br><span class="line">    openf.close()</span><br><span class="line">    <span class="comment"># &#x27;&#x27;&#x27;文本信息&#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="comment"># print(&#x27;=====================================&#x27;+&#x27;\n&#x27;+&#x27;导入文本信息&#x27;+&#x27;\n&#x27;+&#x27;=====================================&#x27;)</span></span><br><span class="line">    <span class="comment"># print(&#x27;该文本共有%d行&#x27; % txtline + &#x27;\n&#x27; + &#x27;有%d行为空&#x27; % spaceline + &#x27;\n&#x27; + &#x27;空行行数分别为:&#x27; + re.sub(&#x27;&#123;|&#125;&#x27;, &#x27;&#x27;, str(storesp)))</span></span><br></pre></td></tr></table></figure>

<p>到这，代码运行无误的话，数据分析结果已经得到<br>如果我进一步想将分析的结果以邮件的形式发送给别人，可以用下面的代码实现</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">_user = <span class="string">&quot;发送人邮箱地址&quot;</span></span><br><span class="line">smtpserver=<span class="string">&#x27;邮箱SMTP地址&#x27;</span></span><br><span class="line">_<span class="keyword">from</span> = <span class="string">&#x27;发送人姓名&lt;发送人邮箱地址&gt;&#x27;</span></span><br><span class="line">_pwd = <span class="string">&quot;邮箱密码&quot;</span></span><br><span class="line"><span class="comment">#----如果发送多个人用英文半角逗号隔开---</span></span><br><span class="line">_to = <span class="string">&#x27;收件人名字&lt;收件人邮箱地址&gt;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;我们编写了一个函数_format_addr()来格式化一个邮件地址。</span></span><br><span class="line"><span class="string">注意不能简单地传入name &lt;addr@example.com&gt;，</span></span><br><span class="line"><span class="string">因为如果包含中文，需要通过Header对象进行编码。---廖雪峰&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_format_addr</span>(<span class="params">s</span>):</span><br><span class="line">    name, addr = parseaddr(s)</span><br><span class="line">    <span class="keyword">return</span> formataddr((Header(name, <span class="string">&#x27;utf-8&#x27;</span>).encode(), addr))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如名字所示Multipart就是分多个部分</span></span><br><span class="line">msg = MIMEMultipart()</span><br><span class="line">msg[<span class="string">&quot;Subject&quot;</span>] = <span class="string">&quot;邮件名字&quot;</span></span><br><span class="line">msg[<span class="string">&quot;From&quot;</span>] =_format_addr( _<span class="keyword">from</span>)</span><br><span class="line">msg[<span class="string">&quot;To&quot;</span>] = _to</span><br><span class="line"></span><br><span class="line"><span class="comment"># ---这是文字图片部分---</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">addimg</span>(<span class="params">src, imgid</span>):<span class="comment"># 添加图片函数，参数1：图片路径，参数2：图片id</span></span><br><span class="line">    fp = <span class="built_in">open</span>(src, <span class="string">&#x27;rb&#x27;</span>)<span class="comment"># 打开文件</span></span><br><span class="line">    msgImage = MIMEImage(fp.read())<span class="comment"># 创建MIMEImage对象，读取图片内容并作为参数</span></span><br><span class="line">    fp.close()<span class="comment"># 关闭文件</span></span><br><span class="line">    msgImage.add_header(<span class="string">&#x27;Content-ID&#x27;</span>, imgid)<span class="comment"># 指定图片文件的Content-ID，imgid，&lt;img&gt;标签中的src用到</span></span><br><span class="line">    <span class="keyword">return</span> msgImage<span class="comment"># 返回msgImage对象</span></span><br><span class="line"><span class="comment">#msg = MIMEMultipart(&#x27;related&#x27;)# 创建MIMEMultipart对象，采用related定义内嵌资源的邮件体</span></span><br><span class="line"><span class="comment">#msg[&quot;Subject&quot;] = &quot;ArcGISzhihu&quot;</span></span><br><span class="line">part = MIMEText(<span class="string">&#x27;&lt;font size=&quot;18px&quot; color=red&gt;&lt;b&gt;&lt;center&gt;ArcGIS知乎站内搜索关键词统计（详情见附件）&lt;/center&gt;&lt;/b&gt;&lt;/font&gt;&#x27;</span>+<span class="string">&#x27;&lt;br/&gt;&lt;b&gt;&lt;center&gt;数据图表获取生成时间：&#x27;</span>+<span class="built_in">str</span>(datetime.datetime.now())+<span class="string">&#x27;&lt;/center&gt;&lt;/b&gt;&lt;img width=&quot;1300px&quot; src=&quot;cid:pic&quot;&gt;&#x27;</span>,<span class="string">&quot;html&quot;</span>,<span class="string">&quot;utf-8&quot;</span> )</span><br><span class="line">msg.attach(part)</span><br><span class="line"><span class="comment"># image = MIMEImage(open(&#x27;C://Users//Esri//Desktop//0b7b02087bf40ad14cc91cbd5f2c11dfa9eccebb.jpg&#x27;,&#x27;rb&#x27;).read()).add_header(&#x27;Content-ID&#x27;,&#x27;men&#x27;)</span></span><br><span class="line">msg.attach(addimg(savename,<span class="string">&quot;pic&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># ---这是附件部分---</span></span><br><span class="line"></span><br><span class="line">part = MIMEApplication(<span class="built_in">open</span>(<span class="string">&#x27;C://Users//Esri//Desktop//statistics//爬取的数据源.xlsx&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read())</span><br><span class="line">part.add_header(<span class="string">&#x27;Content-Disposition&#x27;</span>, <span class="string">&#x27;attachment&#x27;</span>, filename=(<span class="string">&#x27;gbk&#x27;</span>, <span class="string">&#x27;&#x27;</span>,<span class="string">&quot;爬取的数据源.xlsx&quot;</span>))</span><br><span class="line">msg.attach(part)</span><br><span class="line"></span><br><span class="line">part = MIMEApplication(<span class="built_in">open</span>(<span class="string">&#x27;C://Users//Esri//Desktop//statistics//每天搜索次数统计.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read())</span><br><span class="line">part.add_header(<span class="string">&#x27;Content-Disposition&#x27;</span>, <span class="string">&#x27;attachment&#x27;</span>, filename=(<span class="string">&#x27;gbk&#x27;</span>, <span class="string">&#x27;&#x27;</span>,<span class="string">&quot;每天搜索次数统计.xlsx&quot;</span>))</span><br><span class="line">msg.attach(part)</span><br><span class="line"></span><br><span class="line">part = MIMEApplication(<span class="built_in">open</span>(<span class="string">&#x27;C://Users//Esri//Desktop//statistics//每月搜索次数统计.xlsx&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read())</span><br><span class="line">part.add_header(<span class="string">&#x27;Content-Disposition&#x27;</span>, <span class="string">&#x27;attachment&#x27;</span>, filename=(<span class="string">&#x27;gbk&#x27;</span>, <span class="string">&#x27;&#x27;</span>,<span class="string">&quot;每月搜索次数统计.xlsx&quot;</span>))</span><br><span class="line">msg.attach(part)</span><br><span class="line"></span><br><span class="line">part = MIMEApplication(<span class="built_in">open</span>(<span class="string">&#x27;C://Users//Esri//Desktop//statistics//关键词top100.xlsx&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read())</span><br><span class="line">part.add_header(<span class="string">&#x27;Content-Disposition&#x27;</span>, <span class="string">&#x27;attachment&#x27;</span>, filename=(<span class="string">&#x27;gbk&#x27;</span>, <span class="string">&#x27;&#x27;</span>,<span class="string">&quot;关键词top100.xlsx&quot;</span>))</span><br><span class="line">msg.attach(part)</span><br><span class="line"></span><br><span class="line">part = MIMEApplication(<span class="built_in">open</span>(savename, <span class="string">&#x27;rb&#x27;</span>).read())</span><br><span class="line">part.add_header(<span class="string">&#x27;Content-Disposition&#x27;</span>, <span class="string">&#x27;attachment&#x27;</span>, filename=(<span class="string">&#x27;gbk&#x27;</span>, <span class="string">&#x27;&#x27;</span>,<span class="string">&quot;Top20统计结果直方图.png&quot;</span>))</span><br><span class="line">msg.attach(part)</span><br><span class="line"></span><br><span class="line">part = MIMEApplication(<span class="built_in">open</span>(savets, <span class="string">&#x27;rb&#x27;</span>).read())</span><br><span class="line">part.add_header(<span class="string">&#x27;Content-Disposition&#x27;</span>, <span class="string">&#x27;attachment&#x27;</span>, filename=(<span class="string">&#x27;gbk&#x27;</span>, <span class="string">&#x27;&#x27;</span>,<span class="string">&quot;每天统计结果折点图.png&quot;</span>))</span><br><span class="line">msg.attach(part)</span><br><span class="line"></span><br><span class="line">part = MIMEApplication(<span class="built_in">open</span>(savemonth, <span class="string">&#x27;rb&#x27;</span>).read())</span><br><span class="line">part.add_header(<span class="string">&#x27;Content-Disposition&#x27;</span>, <span class="string">&#x27;attachment&#x27;</span>, filename=(<span class="string">&#x27;gbk&#x27;</span>, <span class="string">&#x27;&#x27;</span>,<span class="string">&quot;每月统计结果折点图.png&quot;</span>))</span><br><span class="line">msg.attach(part)</span><br><span class="line"></span><br><span class="line">s = smtplib.SMTP(smtpserver,<span class="number">25</span>)  <span class="comment"># 连接smtp邮件服务器,端口默认是25</span></span><br><span class="line">s.login(_user, _pwd)  <span class="comment"># 登陆服务器</span></span><br><span class="line">s.sendmail(_user, _to.split(<span class="string">&#x27;,&#x27;</span>), msg.as_string())  <span class="comment"># 发送邮件</span></span><br><span class="line">s.close()</span><br></pre></td></tr></table></figure>
<p><img src="/images/02098.jpg" alt="邮件"></p>
<p>如果想知道运行这些过程消耗的时间，可以在最后加上以下代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;执行操作时间&#x27;&#x27;&#x27;</span></span><br><span class="line">endtime = datetime.datetime.now()</span><br><span class="line">time = (endtime - starttime).seconds</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;------------------------------------------------------&#x27;</span> + <span class="string">&#x27;\n&#x27;</span> + <span class="string">&quot;一共用时&quot;</span> + <span class="built_in">str</span>(time) + <span class="string">&quot;秒&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;邮件发送给:%s&#x27;</span>%_to.split(<span class="string">&#x27;,&#x27;</span>))</span><br></pre></td></tr></table></figure>

<h2 id="最后的最后，如果你觉得每天的统计次数成图效果不好，可以制作一个HTML网页去展示，调用js的C3库，易于交互查看"><a href="#最后的最后，如果你觉得每天的统计次数成图效果不好，可以制作一个HTML网页去展示，调用js的C3库，易于交互查看" class="headerlink" title="最后的最后，如果你觉得每天的统计次数成图效果不好，可以制作一个HTML网页去展示，调用js的C3库，易于交互查看    "></a><strong>最后的最后，如果你觉得每天的统计次数成图效果不好，可以制作一个HTML网页去展示，调用js的C3库，易于交互查看</strong>    </h2><p><img src="/images/02097.jpg" alt="html网页展示"></p>

      
    </div>
	
    <footer class="article-footer">
      <a data-url="http://zyouzz.github.io/2017/02/09/65202.html" data-id="cmldil2lk006jj4ticyq3fjtb" class="article-share-link">分享</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/" rel="tag">python</a></li></ul>

	

    </footer>
  </div>

    
<nav id="article-nav">
  
    <a href="/2017/02/17/4127.html" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          python学习小记
        
      </div>
    </a>
  
  
    <a href="/2017/01/18/31842.html" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">与ArcGIS有冲突的软件---黑名单（不定期更新）</div>
    </a>
  
</nav>

  
</article>
</section>
        
          <aside id="sidebar">
  
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="widget-wrap">
    <h3  class="widget-title">博客始于2016年08月02日</h3>
    <h3  class="widget-title">统计自2023年05月31日</h3>
    <div class="widget">
        <span id="busuanzi_container_site_pv">
            <span style="color:#258fb8">总访问量 <span style="color:#e32d40" id="busuanzi_value_site_pv"></span> 次</span>
        </span>
        <br>
        <span id="busuanzi_container_site_uv">
            <span style="color:#258fb8">访客人数 <span style="color:#e32d40" id="busuanzi_value_site_uv"></span> 人</span>
        </span>
    </div>
</div>
  
    <div class="widget-wrap">
	<h3  class="widget-title">微信公众号：zyouzz</h3>
	<div class="widget">
		<img src="/css/images/weixin.jpg">
	</div>
</div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2026/02/08/53467.html">Cesium 实现军事作战规划的现代化与同步</a>
          </li>
        
          <li>
            <a href="/2025/12/10/53235.html">PerInstanceColorAppearance笔记</a>
          </li>
        
          <li>
            <a href="/2025/11/25/27323.html">什么是离屏渲染</a>
          </li>
        
          <li>
            <a href="/2025/11/25/4244.html">高斯泼溅中粒子的协方差矩阵是做什么的</a>
          </li>
        
          <li>
            <a href="/2025/09/16/24077.html">EASY-3D-SDK：强大的二三维一体WebGIS开发框架</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2026/02/">二月 2026</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/12/">十二月 2025</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/11/">十一月 2025</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/09/">九月 2025</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/07/">七月 2025</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/04/">四月 2025</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/03/">三月 2025</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/02/">二月 2025</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/04/">四月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/02/">二月 2024</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/01/">一月 2024</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">十一月 2023</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/09/">九月 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/08/">八月 2023</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/07/">七月 2023</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/06/">六月 2023</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">五月 2023</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">十月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">八月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">十二月 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">六月 2020</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">一月 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">十一月 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">九月 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">八月 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">七月 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">六月 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">四月 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">一月 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">十二月 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">五月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">四月 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">三月 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">二月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">一月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">十二月 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">十一月 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">十月 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">九月 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">八月 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">七月 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">六月 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">五月 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">三月 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">二月 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">一月 2017</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">十二月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">十一月 2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">十月 2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">九月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">八月 2016</a><span class="archive-list-count">12</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/ArcGIS/">ArcGIS</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/GIS/">GIS</a><span class="category-list-count">24</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/GIS/RS/">RS</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9D%82%E8%AE%B0/">杂记</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BC%96%E7%A8%8B/">编程</a><span class="category-list-count">2</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/2024/" rel="tag">2024</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/AI/" rel="tag">AI</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ArcGIS/" rel="tag">ArcGIS</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ArcGIS-Datastore/" rel="tag">ArcGIS Datastore</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ArcGIS-Enterprise/" rel="tag">ArcGIS Enterprise</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ArcGIS-Portal/" rel="tag">ArcGIS Portal</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ArcGIS-Pro/" rel="tag">ArcGIS Pro</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ArcGIS-Server/" rel="tag">ArcGIS Server</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Cesium/" rel="tag">Cesium</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ECW%E5%BD%B1%E5%83%8F/" rel="tag">ECW影像</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Esri/" rel="tag">Esri</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Excel/" rel="tag">Excel</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GIS/" rel="tag">GIS</a><span class="tag-list-count">21</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GLSL/" rel="tag">GLSL</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GPU/" rel="tag">GPU</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript/" rel="tag">JavaScript</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScripts/" rel="tag">JavaScripts</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Leaflet/" rel="tag">Leaflet</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/" rel="tag">Linux</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ModelBuilder/" rel="tag">ModelBuilder</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PerInstanceColorAppearance/" rel="tag">PerInstanceColorAppearance</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Portal/" rel="tag">Portal</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python%E8%84%9A%E6%9C%AC%E5%B7%A5%E5%85%B7/" rel="tag">Python脚本工具</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RS/" rel="tag">RS</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TypeScript/" rel="tag">TypeScript</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VUE/" rel="tag">VUE</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vite/" rel="tag">Vite</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vue3/" rel="tag">Vue3</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WebGIS/" rel="tag">WebGIS</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WebGL/" rel="tag">WebGL</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/arcgis/" rel="tag">arcgis</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/arcmap/" rel="tag">arcmap</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/bash/" rel="tag">bash</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/blog/" rel="tag">blog</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cesium/" rel="tag">cesium</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/geoserver/" rel="tag">geoserver</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/glsl/" rel="tag">glsl</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gtopo30/" rel="tag">gtopo30</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/" rel="tag">hexo</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/modis/" rel="tag">modis</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pg/" rel="tag">pg</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/postgresql/" rel="tag">postgresql</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/postman/" rel="tag">postman</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/" rel="tag">python</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/texture/" rel="tag">texture</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/texture2D/" rel="tag">texture2D</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/token/" rel="tag">token</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tomcat/" rel="tag">tomcat</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xlsx/" rel="tag">xlsx</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%89%E7%BB%B4/" rel="tag">三维</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%89%E7%BB%B4%E5%9C%BA%E6%99%AF/" rel="tag">三维场景</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%96%E7%95%8C/" rel="tag">世界</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%AD%E5%9B%BD/" rel="tag">中国</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%8C%E7%BA%A7%E8%B7%AF%E5%BE%84%E5%9F%9F%E5%90%8D/" rel="tag">二级路径域名</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%8C%E7%BB%B4/" rel="tag">二维</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%9A%E6%B4%B2/" rel="tag">亚洲</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%AC%E9%92%93%E5%AE%9D/" rel="tag">京钓宝</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/" rel="tag">人工智能</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BC%98%E5%8A%BF/" rel="tag">优势</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%85%89%E4%BC%8F/" rel="tag">光伏</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%85%A8%E5%9B%BD/" rel="tag">全国</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%86%9B%E4%BA%8B%E4%BD%9C%E6%88%98%E8%A7%84%E5%88%92/" rel="tag">军事作战规划</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%87%BA%E5%B7%AE/" rel="tag">出差</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%90%AF%E5%8A%A8/" rel="tag">启动</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9B%BE%E5%BD%A2%E7%BB%98%E5%88%B6/" rel="tag">图形绘制</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9C%B0%E7%90%86%E7%A9%BA%E9%97%B4%E4%BA%91/" rel="tag">地理空间云</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9D%90%E6%A0%87/" rel="tag">坐标</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%9A%E5%AD%97%E6%AE%B5/" rel="tag">多字段</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%9A%E8%BF%9B%E7%A8%8B/" rel="tag">多进程</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AD%97%E6%AE%B5%E8%AE%A1%E7%AE%97%E5%99%A8/" rel="tag">字段计算器</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AE%89%E8%A3%85/" rel="tag">安装</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BD%B1%E5%83%8F/" rel="tag">影像</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/" rel="tag">微信小程序</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%89%B9%E9%87%8F/" rel="tag">批量</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8A%80%E5%B7%A7/" rel="tag">技巧</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8A%80%E6%9C%AF%E7%AA%81%E7%A0%B4/" rel="tag">技术突破</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8A%A5%E5%91%8A/" rel="tag">报告</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8E%A5%E5%8F%A3/" rel="tag">接口</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/" rel="tag">搜索引擎</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag">数据库</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%97%A0%E4%BA%BA%E6%9C%BA/" rel="tag">无人机</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9D%82%E8%AE%B0/" rel="tag">杂记</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%AC%A7%E6%B4%B2/" rel="tag">欧洲</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%AD%A6%E6%B1%89/" rel="tag">武汉</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/" rel="tag">注意事项</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B8%B2%E6%9F%93%E7%AE%A1%E7%BA%BF/" rel="tag">渲染管线</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%82%B9%E6%8E%92%E5%BA%8F/" rel="tag">点排序</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%A6%BB%E5%B1%8F%E6%B8%B2%E6%9F%93/" rel="tag">离屏渲染</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AC%94%E8%AE%B0/" rel="tag">笔记</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AC%A6%E5%8F%B7%E6%B8%B2%E6%9F%93/" rel="tag">符号渲染</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BC%96%E5%8F%B7/" rel="tag">编号</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%88%AA%E7%8F%AD/" rel="tag">航班</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%90%A4%E7%81%AB%E5%9B%BE/" rel="tag">萤火图</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/" rel="tag">解决方案</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%B7%A8%E5%9F%9F/" rel="tag">跨域</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%80%8F%E8%A7%86%E8%A1%A8/" rel="tag">透视表</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%92%93%E9%B1%BC%E4%BD%AC/" rel="tag">钓鱼佬</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%97%AE%E9%A2%98/" rel="tag">问题</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9A%8F%E7%AC%94/" rel="tag">随笔</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2/" rel="tag">集群部署</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%AB%98%E6%96%AF%E6%B3%BC%E6%BA%85/" rel="tag">高斯泼溅</a><span class="tag-list-count">2</span></li></ul>
    </div>
  </div>


  
    <div class="widget-wrap">
	<h3  class="widget-title">友情链接</h3>
	<div class="widget">
		<ul class="entry">
			<li><a target="_blank" rel="noopener" href="http://www.esrichina.com.cn/" title="Esri中国">Esri中国</a></li>
			<li><a target="_blank" rel="noopener" href="http://blog.sina.com.cn/enviidl" title="ENVI-IDL技术殿堂的博客">ENVI-IDL技术殿堂的博客</a></li>
			<li><a target="_blank" rel="noopener" href="http://zhihu.esrichina.com.cn/" title="ArcGIS知乎">ArcGIS知乎</a></li>
			<li><a target="_blank" rel="noopener" href="http://kikitamap.com/" title="kikita&maps">kikita&maps</a></li>
		</ul>
	</div>
</div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2026 James Rock<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
	
  </div>
  <script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script>
  <script>LA.init({id:"3HYCEbjiW2zuEoLJ",ck:"3HYCEbjiW2zuEoLJ"})</script>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
    <a href="/tags/Cesium" class="mobile-nav-link">Cesium</a>
  
    <a href="/tags/WebGL" class="mobile-nav-link">WebGL</a>
  
    <a href="/tags/GIS" class="mobile-nav-link">GIS</a>
  
    <a href="/tags/RS" class="mobile-nav-link">RS</a>
  
    <a href="/about" class="mobile-nav-link">关于</a>
  
</nav>
    


<script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
<script type="text/javascript">
//<![CDATA[
if (typeof jQuery == 'undefined') {
document.write(unescape("%3Cscript src='https://cdn.bootcdn.net/ajax/libs/jquery/3.6.4/jquery.min.js' type='text/javascript'%3E%3C/script%3E"));
}
// ]]>
</script>


  
<link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css">

  
<script src="https://cdn.bootcdn.net/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>


<div id="totop" style="z-index: 9999;position:fixed;bottom:150px;right:20px;cursor: pointer;">
		<a title="返回顶部"><img src="/css/images/totop.png"/></a>
</div>
<script src="/js/totop.js"></script>

<script type="text/javascript">      
     var search_path = "search.xml";
     if (search_path.length == 0) {
     	search_path = "search.xml";
     }
     var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
</script>


  </div>
</body>
</html>